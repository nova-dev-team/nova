<?xml version="1.0" encoding="UTF-8"?>
<!-- ====================================================================== 
     Mar 24, 2011 9:31:31 PM                                                        

     Nova
     Virtualization management system
                   
     Santa Zhang (santa1987@gmail.com)
     ====================================================================== -->
<project name="Nova" default="build">
	<description>
    	Virtualization management system
    </description>


	<target name="check-env" description="check build environment">
		<mkdir dir="bin"/>
	</target>


	<target name="build" depends="check-env" description="build project">
		<javac srcdir="src" destdir="bin" includeantruntime="false">
			<classpath>
				<fileset dir="lib">
					<include name="**/*.jar"/>
				</fileset>
			</classpath>
		</javac>
		<copy file="conf/log4j.properties" todir="bin/" />
	</target>

  <target name="pre-test" depends="build" description="prepare test environment">
    <mkdir dir="bin/junit-temp"/>
    <mkdir dir="bin/junit-report"/>
  </target>

	<target name="test" depends="pre-test" description="run junit4 tests">
    <junit printsummary="false" filtertrace="true" haltonfailure="true" tempdir="bin/junit-temp">
      <formatter type="xml"/>
			<classpath>
				<fileset dir="lib">
					<include name="**/*.jar"/>
				</fileset>
				<fileset dir="conf"/>
			</classpath>
      <batchtest todir="bin/junit-report">
        <fileset dir="bin/">
          <include name="nova/test/**/*.class" />
        </fileset>
			</batchtest>
		</junit>
	</target>


	<target name="clean" description="clean build files">
    <delete dir="bin/" />
	</target>

</project>
